<h4>SOLICITUD DE FONDOS EN AVANCE</h4>
<form [formGroup]="fundingRequestForm">
  <mat-expansion-panel class="sz-details-panel">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Datos personales - Solicitante
      </mat-panel-title>
      <mat-panel-description>
        <span *ngIf="currentUser">{{currentUser.name}} {{currentUser.lastName}}</span>
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-form-field>
      <mat-select placeholder="Usuario solicitante" [(value)]='selectedUserId' (selectionChange)="updateCurrentSelectedUser()">
        <mat-option *ngFor="let user of users" [value]='user.id'>
          {{user.name}} {{user.lastName}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <div *ngIf="selectedUserId">
      <mat-form-field>
        <input matInput placeholder="Nombres y apellidos" [value]="currentUser.name + ' ' + currentUser.lastName" [readonly]="true">
      </mat-form-field>
      <br>
      <mat-form-field>
        <input matInput placeholder="Cargo" [value]="currentUser.position" [readonly]="true">
      </mat-form-field>
      <br>
      <mat-form-field>
        <input matInput placeholder="Carnet de Identidad" [value]="currentUser.ci" [readonly]="true">
      </mat-form-field>
      <br>
      <mat-form-field>
        <input matInput placeholder="Expedido" [value]="currentUser.ciPlace" [readonly]="true">
      </mat-form-field>
    </div>
  </mat-expansion-panel>

  <mat-expansion-panel class="sz-details-panel">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Detalle de Solicitud
      </mat-panel-title>
      <mat-panel-description>
        <!-- description -->
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-form-field>
      <mat-select placeholder="Cliente" [(value)]='selectedClientId' (selectionChange)="updateCurrentSelectedClient()">
        <mat-option *ngFor="let client of clients" [value]='client.id'>
          {{client.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>
    <mat-form-field>
      <input matInput [matDatepicker]="frDate" placeholder="Fecha">
      <mat-datepicker-toggle matSuffix [for]="frDate"></mat-datepicker-toggle>
      <mat-datepicker #frDate></mat-datepicker>
    </mat-form-field>
    <br>
    <mat-form-field>
      <input matInput placeholder="Motivo del gasto">
    </mat-form-field>
  </mat-expansion-panel>
  <mat-expansion-panel class="sz-details-panel">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Lista de Items
      </mat-panel-title>
      <mat-panel-description>
        <!-- description -->
      </mat-panel-description>
    </mat-expansion-panel-header>
    <table mat-table class="mat-elevation-z2 sz-item-table" [dataSource]="items" matSort>
      <ng-container matColumnDef="position">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Item </th>
        <td mat-cell *matCellDef="let frItem; let idx = index"> {{idx + 1}} </td>
        <td mat-footer-cell *matFooterCellDef> </td>
      </ng-container>
      <ng-container matColumnDef="detail">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Detalle </th>
        <td mat-cell *matCellDef="let frItem"> {{frItem.detail}} </td>
        <td mat-footer-cell *matFooterCellDef> </td>
      </ng-container>
      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Cantidad </th>
        <td mat-cell *matCellDef="let frItem"> {{frItem.quantity}} </td>
        <td mat-footer-cell *matFooterCellDef> </td>
      </ng-container>
      <ng-container matColumnDef="singlePrice">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Precio Unitario </th>
        <td mat-cell *matCellDef="let frItem"> {{frItem.singlePrice}} </td>
        <td mat-footer-cell *matFooterCellDef> Total: </td>
      </ng-container>
      <ng-container matColumnDef="totalPrice">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> precio Total </th>
        <td mat-cell *matCellDef="let frItem"> {{frItem.totalPrice}} </td>
        <td mat-footer-cell *matFooterCellDef> {{ getFrTotal() }} </td>
      </ng-container>
      <ng-container matColumnDef="editBtn">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> </th>
        <td mat-cell *matCellDef="let frItem; let idx = index">
          <button mat-raised-button color="primary" (click)="addFundingRequestItem(frItem)"> Editar </button>
          <button mat-button color="primary" (click)="deleteFundingRequestItem(idx)"> Eliminar </button>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="frColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: frColumns;"></tr>
      <tr mat-footer-row *matFooterRowDef="frColumnsFooter"></tr>
    </table>
    <br>
    <button mat-raised-button color="primary" (click)="addFundingRequestItem()">
      AÃ±adir
    </button>
  </mat-expansion-panel>
  <mat-expansion-panel class="sz-details-panel">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Observaciones
      </mat-panel-title>
      <mat-panel-description>
        <!-- description -->
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-form-field>
      <textarea matInput placeholder="Observaciones"></textarea>
    </mat-form-field>
    <br>
    <mat-form-field>
      <input matInput placeholder="Solicitado por " [value]="'solicitante'" [readonly]="true">
    </mat-form-field>
    <br>
    <mat-form-field>
      <input matInput placeholder="Autorizado por " [value]="'usuario autorizador'" [readonly]="true">
    </mat-form-field>
  </mat-expansion-panel>
  <mat-expansion-panel class="sz-details-panel">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Conformidad de la Solicitud
      </mat-panel-title>
      <mat-panel-description>
        <!-- description -->
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-form-field>
      <input matInput placeholder="No. de Solicitud " [value]="'sol 101'" [readonly]="true">
    </mat-form-field>
    <br>
    <mat-form-field>
      <input matInput placeholder="Entregado en " [value]="'Efectivo'">
    </mat-form-field>
    <br>
    <mat-form-field>
      <input matInput placeholder="Entregado por " [value]="'solicitante'" [readonly]="true">
    </mat-form-field>
    <br>
    <mat-form-field>
      <input matInput placeholder="Recibido por " [value]="'Usuario Receptor'" [readonly]="true">
    </mat-form-field>
  </mat-expansion-panel>
</form>