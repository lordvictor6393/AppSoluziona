<h2 mat-dialog-title> Vista previa </h2>
<mat-dialog-content>
  <kendo-pdf-export #frPrintPreview paperSize="Letter" margin="0.5in">
    <div class="main-page">
      <div class="panel header">
        <span class="logo">
          SoluZiona
        </span>
        <span class="title">
          DESCARGO DE FONDOS
          <br>EN AVANCE
        </span>
        <span class="codes">
          <div class="project-code">{{proj.code}}</div>
          <div class="funding-request-code">{{er.code}}</div>
        </span>
      </div>

      <div class="panel personal-data">
        <div class="title">A. DATOS PERSONALES</div>
        <div class="data-table">
          <div class="row">
            <div class="cell label" style="width: 25%;">Nombre y Apellidos: </div>
            <div class="cell" style="width: 40%;"> {{owner.name + ' ' + owner.lastName}} </div>
            <div class="cell label" style="width: 15%;"> Cargo: </div>
            <div class="cell" style="width: 20%;"> {{owner.position}} </div>
          </div>
          <div class="row">
            <div class="cell label" style="width: 25%;">Carnet de Identidad: </div>
            <div class="cell" style="width: 40%;"> {{owner.ci}} </div>
            <div class="cell label" style="width: 15%;"> Expedido: </div>
            <div class="cell" style="width: 20%;"> {{owner.ciPlace}} </div>
          </div>
        </div>
      </div>

      <div class="panel detail">
        <div class="title">B. DETALLE DE GASTOS REALIZADOS</div>
        <div class="data-table">
          <div class="row">
            <div class="cell label" style="width: 25%;">Proyecto: </div>
            <div class="cell" style="width: 40%;"> {{proj.name}} </div>
            <div class="cell label" style="width: 15%;">Fecha: </div>
            <div class="cell" style="width: 20%;"> {{er.date | date:'mediumDate'}} </div>
          </div>
        </div>
        <hr>
        <div class="data-table border">
          <div class="row header-row">
            <div class="cell" style="width: 6%;">Item</div>
            <div class="cell" style="width: 34%;">Detalle</div>
            <div class="cell" style="width: 10%;">Fecha</div>
            <div class="cell" style="width: 10%;">No. de Factura</div>
            <div class="cell" style="width: 10%;">No. de Recibo</div>
            <div class="cell" style="width: 10%;">Cantidad</div>
            <div class="cell" style="width: 10%;">Precio Unitario</div>
            <div class="cell" style="width: 10%;">Precio Total</div>
          </div>
          <div class="row" *ngFor="let item of er.items; let idx = index">
            <div class="cell justified" style="width: 6%;"> {{idx + 1}} </div>
            <div class="cell" style="width: 34%;"> {{item.detail}} </div>
            <div class="cell justified" style="width: 10%;"> {{item.date | date: 'shortDate'}} </div>
            <div class="cell justified" style="width: 10%;"> {{item.billNumber}} </div>
            <div class="cell justified" style="width: 10%;"> {{item.voucherNumber}} </div>
            <div class="cell justified" style="width: 10%;"> {{item.quantity}} </div>
            <div class="cell justified" style="width: 10%;"> {{item.singlePrice}} </div>
            <div class="cell justified" style="width: 10%;"> {{item.totalPrice}} </div>
          </div>
          <div class="row" *ngFor="let item of emptyRows; let idx = index">
            <div class="cell justified" style="width: 6%;"> {{idx + er.items.length + 1}} </div>
            <div class="cell" style="width: 34%;"> </div>
            <div class="cell justified" style="width: 10%;"> </div>
            <div class="cell justified" style="width: 10%;"> </div>
            <div class="cell justified" style="width: 10%;"> </div>
            <div class="cell justified" style="width: 10%;"> </div>
            <div class="cell justified" style="width: 10%;"> </div>
            <div class="cell justified" style="width: 10%;"> </div>
          </div>
        </div>
        <div class="data-table totals" style="margin-top: 5px">
          <div class="row footer-row">
            <div class="cell" style="width: 55%;"></div>
            <div class="cell justified total-label" style="width: 30%;"> Total Gastos Realizados </div>
            <div class="cell justified total-amount" style="width: 15%;"> {{er.totalSpent}} </div>
          </div>
          <div class="row footer-row">
            <div class="cell" style="width: 55%;"></div>
            <div class="cell justified total-label" style="width: 30%;"> Fondos Recibidos </div>
            <div class="cell justified total-amount" style="width: 15%;"> {{er.totalReceived}} </div>
          </div>
          <div class="row footer-row">
            <div class="cell" style="width: 55%;"></div>
            <div class="cell justified total-label" style="width: 30%;"> Saldo </div>
            <div class="cell justified total-amount" style="width: 15%;"> {{er.balance}} </div>
          </div>
        </div>
        <div class="data-table" style="margin-top: 10px">
          <div class="row">
            <div class="cell label" style="width: 20%;"> Observaciones: </div>
            <div class="cell" style="width: 80%;"> {{fr.observations}} </div>
          </div>
        </div>
      </div>

      <div class="panel accordance">
        <div class="title">C. CONFORMIDAD DE LA RENDICIÓN</div>
        <div class="data-table">
          <div class="row">
            <div class="cell label" style="width: 35%;">Orden de Servicio: </div>
            <div class="cell" style="width: 15%;"> </div>
            <div class="cell label" style="width: 20%;"> Aceptado por: </div>
            <div class="cell" style="width: 30%;"> </div>
          </div>
          <div class="row">
            <div class="cell label" style="width: 35%;">Número de Solicitud: </div>
            <div class="cell" style="width: 15%;"> {{fr.code}}</div>
            <div class="cell label" style="width: 20%;"> Firma: </div>
            <div class="cell" style="width: 30%;"> </div>
          </div>
          <div class="row">
            <div class="cell label" style="width: 35%;">Saldo: </div>
            <div class="cell" style="width: 15%;"> {{er.balance}}</div>
            <div class="cell label" style="width: 20%;"> Nombre y Apellido: </div>
            <div class="cell" style="width: 30%;"> {{approver.name + ' ' + approver.lastName}} </div>
          </div>
          <div class="row">
            <div class="cell label" style="width: 35%;">No. de Comprobante: </div>
            <div class="cell" style="width: 15%;"> </div>
            <div class="cell" style="width: 50%;"> </div>
          </div>
        </div>
      </div>
    </div>
  </kendo-pdf-export>
</mat-dialog-content>

<mat-dialog-actions>
  <button mat-raised-button color="primary" (click)="frPrintPreview.saveAs('itWorksKendo.pdf')">Exportar a PDF</button>
  <button mat-button color="primary" mat-dialog-close> Cerrar </button>
</mat-dialog-actions>